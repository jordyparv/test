// Constants for column names
const constants = {
    OpsTechColName: [
        "tech_name", "tech_name_2", "tech_name_3", "tech_name_4", "tech_name_5", "tech_name_6",
        "tech_name_7", "tech_name_8", "tech_name_9", "tech_name_10", "tech_name_11", "tech_name_12",
        "tech_name_13", "tech_name_14", "tech_name_15", "tech_name_16", "tech_name_17", "tech_name_18",
        "tech_name_19", "tech_name_20", "tech_name_21", "tech_name_22", "tech_name_23", "tech_name_24",
        "tech_name_25", "tech_name_26", "tech_name_27", "tech_name_28", "tech_name_29", "tech_name_30"
    ],
    OpsMgrColName: ["manager_id", "manager_id_2"],
    OpsImpEngColName: ["IMP_ENGINEER_ID", "IMP_MANAGER_ID"]
};

// Sample insertBindParams with roles and user IDs
const insertBindParams = [
    { switchUnid: 'SWITCH001', role: 'SWITCH_TECHNICIAN', userid: 'John_Doe', fname: 'John', lname: 'Doe' },
    { switchUnid: 'SWITCH001', role: 'SWITCH_MANAGER', userid: 'Jane_Smith', fname: 'Jane', lname: 'Smith' },
    { switchUnid: 'SWITCH001', role: 'IMPLEMENTATION_ENGINEER', userid: 'Alice_Johnson', fname: 'Alice', lname: 'Johnson' },
    { switchUnid: 'SWITCH002', role: 'SWITCH_TECHNICIAN', userid: 'Mike_Brown', fname: 'Mike', lname: 'Brown' },
    { switchUnid: 'SWITCH002', role: 'SWITCH_MANAGER', userid: 'Sarah_Davis', fname: 'Sarah', lname: 'Davis' },
    { switchUnid: 'SWITCH002', role: 'IMPLEMENTATION_ENGINEER', userid: 'Robert_Wilson', fname: 'Robert', lname: 'Wilson' },
    { switchUnid: 'SWITCH003', role: 'SWITCH_TECHNICIAN', userid: 'Emily_Miller', fname: 'Emily', lname: 'Miller' },
    { switchUnid: 'SWITCH003', role: 'SWITCH_MANAGER', userid: 'David_Taylor', fname: 'David', lname: 'Taylor' },
    { switchUnid: 'SWITCH003', role: 'IMPLEMENTATION_ENGINEER', userid: 'Olivia_Moore', fname: 'Olivia', lname: 'Moore' },
    { switchUnid: 'SWITCH004', role: 'SWITCH_TECHNICIAN', userid: 'Daniel_Anderson', fname: 'Daniel', lname: 'Anderson' },
    { switchUnid: 'SWITCH004', role: 'SWITCH_MANAGER', userid: 'Rachel_Jackson', fname: 'Rachel', lname: 'Jackson' },
    { switchUnid: 'SWITCH004', role: 'IMPLEMENTATION_ENGINEER', userid: 'James_Lee', fname: 'James', lname: 'Lee' },
    { switchUnid: 'SWITCH005', role: 'SWITCH_TECHNICIAN', userid: 'Sophia_Harris', fname: 'Sophia', lname: 'Harris' },
    { switchUnid: 'SWITCH005', role: 'SWITCH_MANAGER', userid: 'William_Clark', fname: 'William', lname: 'Clark' },
    { switchUnid: 'SWITCH005', role: 'IMPLEMENTATION_ENGINEER', userid: 'Liam_Lewis', fname: 'Liam', lname: 'Lewis' },
    { switchUnid: 'SWITCH006', role: 'SWITCH_TECHNICIAN', userid: 'Grace_Walker', fname: 'Grace', lname: 'Walker' },
    { switchUnid: 'SWITCH006', role: 'SWITCH_MANAGER', userid: 'Christopher_Allen', fname: 'Christopher', lname: 'Allen' },
    { switchUnid: 'SWITCH006', role: 'IMPLEMENTATION_ENGINEER', userid: 'Ava_Young', fname: 'Ava', lname: 'Young' },
    { switchUnid: 'SWITCH007', role: 'SWITCH_TECHNICIAN', userid: 'Lucas_King', fname: 'Lucas', lname: 'King' },
    { switchUnid: 'SWITCH007', role: 'SWITCH_MANAGER', userid: 'Amelia_Scott', fname: 'Amelia', lname: 'Scott' },
    { switchUnid: 'SWITCH007', role: 'IMPLEMENTATION_ENGINEER', userid: 'Henry_Green', fname: 'Henry', lname: 'Green' }
];

// Provided contactData
const contactData = { 
  "LocationId": 934,
  "AREA": "HQ",
  "REGION": "NEC",
  "Market": "Broadsoft TAS",
  "SWITCH": "Branchburg TAS",
  "SITE_FUNCTION": "Switch",
  "BRAND": "Lucent",
  "Description": "",
  "Address": "",
  "City": "",
  "st": "",
  "Zip": "",
  "County": "",
  "latitude": "",
  "longitude": "",
  "GATE_COMBO": "",
  "GATE_COMBO2": "",
  "DIRECTION": "",
  "RESTRICTION": "",
  "tech_name": "procejo",  // Already populated
  "tech_name_2": "",
  "tech_name_3": "",
  "tech_name_4": "", // Should be populated if empty
  "tech_name_5": "",
  "manager_id": "sepulje",  // Already populated
  "manager_id_2": "",
  "IMP_ENGINEER_ID": "",
  "IMP_MANAGER_ID": "",
  // Other fields omitted for brevity...
};

// Initialize apiPayload as an empty object
let apiPayload = {};

  for(let key in contactData ){
          if(constants.OpsTechColName.includes(key) && (contactData[key] == null || contactData[key] == "")){
            apiPayload[key] = null
          }
          if(constants.OpsMgrColName.includes(key) && (contactData[key] == null || contactData[key] == "")){
            apiPayload[key] = null
          }
          if(constants.OpsImpEngColName.includes(key) && (contactData[key] == null || contactData[key] == "")){
            apiPayload[key] = null
          }
         }

// Get the list of user IDs for each role (techs, mgr, impEng)
let techs = insertBindParams.filter(item => item.role === 'SWITCH_TECHNICIAN').map(item => item.userid);
let mgrs = insertBindParams.filter(item => item.role === 'SWITCH_MANAGER').map(item => item.userid);
let impEngs = insertBindParams.filter(item => item.role === 'IMPLEMENTATION_ENGINEER').map(item => item.userid);
// Output the final apiPayload

for(let key in apiPayload){
    let tech = constants.OpsTechColName.includes(key) && techs.shift()
    let mgr  =constants.OpsMgrColName.includes(key)&& mgrs.shift()
    let impEng = constants.OpsImpEngColName.includes(key)&&impEngs.shift()
    if(constants.OpsTechColName.includes(key)&&tech){
        apiPayload[key] = tech
    }
    else if(constants.OpsMgrColName.includes(key)&&mgr){
        apiPayload[key] = mgr
    }
    else if(constants.OpsImpEngColName.includes(key)&&impEng){
        apiPayload[key] = impEng
    }
}
console.log(apiPayload);


