-- Create the table
CREATE TABLE SWITCH_INSTALLED_SUBELEMENTS (
    SUBELEMENT_ID             NUMBER GENERATED BY DEFAULT AS IDENTITY,
    SUBELEMENT_NAME           VARCHAR2(100),
    SUBELEMENT_ROLE           VARCHAR2(50),
    LOCATIONID                VARCHAR2(50),
    ELEMENTID                 VARCHAR2(50),
    META_UNIVERSALID          VARCHAR2(50),
    META_CREATEDDATE          TIMESTAMP(6),
    META_CREATEDBY            VARCHAR2(100),
    META_LASTUPDATEDATE       TIMESTAMP(6),
    META_LASTUPDATEBY         VARCHAR2(100),
    SOURCE_UNIVERSALID        VARCHAR2(50),
    CONSTRAINT PK_SUBELEMENT PRIMARY KEY (SUBELEMENT_ID)
);

-- Create a sequence for auto-incrementing SUBELEMENT_ID
CREATE SEQUENCE SUBELEMENT_SEQ
    START WITH 1
    INCREMENT BY 1
    NOCACHE
    NOCYCLE;


-- Create a trigger to automatically populate SUBELEMENT_ID
CREATE OR REPLACE TRIGGER TRG_SUBELEMENT_ID
BEFORE INSERT ON SWITCH_INSTALLED_SUBELEMENTS
FOR EACH ROW
BEGIN
    IF :NEW.SUBELEMENT_ID IS NULL THEN
        SELECT SUBELEMENT_SEQ.NEXTVAL
        INTO :NEW.SUBELEMENT_ID
        FROM DUAL;
    END IF;
END;
/
