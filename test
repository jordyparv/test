MERGE INTO OPSINV.SWITCH_ATTACHMENTS tgt
USING (SELECT :META_UNIVERSALID AS id FROM dual) src
ON (src.id = tgt.META_UNIVERSALID)
WHEN MATCHED THEN
    UPDATE SET
        tgt.REFMETAID = :REFMETAID,
        tgt.ATTACHMENT_NAME = :ATTACHMENT_NAME,
        tgt.ATTACHMENT_SIZE = :ATTACHMENT_SIZE,
        tgt.ATTACHMENT_TYPE = :ATTACHMENT_TYPE,
        tgt.ATTACHMENT = :ATTACHMENT,
        tgt.CREATED_ON = TO_DATE(:CREATED_ON, 'YYYY-MM-DD HH24:MI:SS'),
        tgt.CREATED_BY = :CREATED_BY,
        tgt.MODIFIED_ON = TO_DATE(:MODIFIED_ON, 'YYYY-MM-DD HH24:MI:SS'),
        tgt.MODIFIED_BY = :MODIFIED_BY,
        tgt.DESCRIPTION = :DESCRIPTION,
        tgt.SWITCH_UNID = :REFMETAID,
        tgt.ATTACHMENT_CATEGORY = :ATTACHMENT_CATEGORY
WHEN NOT MATCHED THEN
    INSERT (
        REFMETAID,
        ATTACHMENT_NAME,
        ATTACHMENT_SIZE,
        ATTACHMENT_TYPE,
        ATTACHMENT,
        META_UNIVERSALID,
        CREATED_ON,
        CREATED_BY,
        MODIFIED_ON,
        MODIFIED_BY,
        DESCRIPTION,
        SWITCH_UNID,
        ATTACHMENT_CATEGORY
    )
    VALUES (
        :REFMETAID,
        :ATTACHMENT_NAME,
        :ATTACHMENT_SIZE,
        :ATTACHMENT_TYPE,
        :ATTACHMENT,
        :META_UNIVERSALID,
        TO_DATE(:CREATED_ON, 'YYYY-MM-DD HH24:MI:SS'),
        :CREATED_BY,
        TO_DATE(:MODIFIED_ON, 'YYYY-MM-DD HH24:MI:SS'),
        :MODIFIED_BY,
        :DESCRIPTION,
        :REFMETAID,
        :ATTACHMENT_CATEGORY
    )
