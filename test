MERGE INTO SWITCH_ELEMENTS tgt
USING (SELECT :META_UNIVERSAL_ID AS id FROM dual) src
ON (src.id = tgt.META_UNIVERSAL_ID)
WHEN MATCHED THEN
    UPDATE SET
        tgt.ELEMENT_ID = :ELEMENT_ID,
        tgt.DESCRIPTION = :DESCRIPTION,
        tgt.ELEMENT_DIVISION = :ELEMENT_DIVISION,
        tgt.ELEMENT_DEPT = :ELEMENT_DEPT,
        tgt.ELEMENT_SUB_DEPT = :ELEMENT_SUB_DEPT,
        tgt.IS_DISABLED = :IS_DISABLED,
        tgt.META_CREATED_DATE = 
            CASE 
                WHEN :META_CREATED_DATE IS NOT NULL THEN TO_DATE(:META_CREATED_DATE, 'YYYY-MM-DD HH24:MI:SS')
                ELSE tgt.META_CREATED_DATE
            END,
        tgt.META_CREATED_BY = :META_CREATED_BY,
        tgt.META_LAST_UPDATED_DATE = 
            CASE 
                WHEN :META_LAST_UPDATED_DATE IS NOT NULL THEN TO_DATE(:META_LAST_UPDATED_DATE, 'YYYY-MM-DD HH24:MI:SS')
                ELSE tgt.META_LAST_UPDATED_DATE
            END,
        tgt.META_LAST_UPDATED_BY = :META_LAST_UPDATED_BY,
        tgt.NO_DIRTRACKER = :NO_DIRTRACKER
WHEN NOT MATCHED THEN
    INSERT (
        ELEMENT_ID,
        DESCRIPTION,
        ELEMENT_DIVISION,
        ELEMENT_DEPT,
        ELEMENT_SUB_DEPT,
        IS_DISABLED,
        META_UNIVERSAL_ID,
        META_CREATED_DATE,
        META_CREATED_BY,
        META_LAST_UPDATED_DATE,
        META_LAST_UPDATED_BY,
        NO_DIRTRACKER
    )
    VALUES (
        :ELEMENT_ID,
        :DESCRIPTION,
        :ELEMENT_DIVISION,
        :ELEMENT_DEPT,
        :ELEMENT_SUB_DEPT,
        :IS_DISABLED,
        :META_UNIVERSAL_ID,
        TO_DATE(:META_CREATED_DATE, 'YYYY-MM-DD HH24:MI:SS'),
        :META_CREATED_BY,
        TO_DATE(:META_LAST_UPDATED_DATE, 'YYYY-MM-DD HH24:MI:SS'),
        :META_LAST_UPDATED_BY,
        :NO_DIRTRACKER
    )
    -- Here, ensure the new rows don't violate constraints
    ON DUPLICATE KEY UPDATE 
    -- This part might need adjustments for unique constraints if necessary
    tgt.META_UNIVERSAL_ID = :META_UNIVERSAL_ID;
